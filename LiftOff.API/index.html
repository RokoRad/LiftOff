<!DOCTYPE html>
<html>
<head>
	<title>SignalR Simple Chat</title>
	<style type="text/css">
		.container {
			background-color: #99CCFF;
			border: thick solid #808080;
			padding: 20px;
			margin: 20px;
		}
	</style>
</head>
<body>
	<div class="container">
		<input type="text" id="newLatitude" />
		<input type="text" id="newLongitude"/>
		<input type="button" id="sendmessage" value="Send" />
		<input type="hidden" id="latitude" />
		<input type="hidden" id="longitude" />
		<ul id="discussion"></ul>
	</div>

	<script src="Scripts/jquery-3.2.1.min.js"></script>
	<script src="Scripts/jquery.signalR-2.2.2.min.js"></script>
	<script src="signalr/hubs"></script>

	<script type="text/javascript">
		$(function () {
			jQuery.support.cors = true;
			//$.connection.hub.url = 'http:/localhost:52037/signalr';

			var weather = $.connection.weatherHub;

			weather.client.broadcastWeather =  function (weather) {
				var encodedMsg = $('<div />').text(weather).html();
				$('#discussion').append('<li>' + encodedMsg + '</li>');
				console.log(weather);
			}; 

			$('#latitude').val(prompt('Enter your latitude:', ''));
			$('#longitude').val(prompt('Enter your longitude:', ''));

			$('#message').focus();

			//$.connection.hub.start().done(function () {
			//	weather.server.initiateConnection({ Location: { Latitude: $('#latitude').val(), Longitude: $('#longitude').val() }, Date: new Date().toISOString() }, "metric");
   //             console.log("ok")
   //             $('#sendmessage').click(function () {
			//		//weather.server.updateLocation({ Location: { Latitude: $('#newLatitude').val(), Longitude: $('#newLongitude').val() }, Date: (new Date()).toISOString() });
			//		weather.server.changeUnits();

			//		$('#newLatitude').val('').focus();
			//		$('#newLongitude').val('');
			//	});
   //         }).fail(function () { console.log("fail"); });
		});
	</script>
</body>
</html>